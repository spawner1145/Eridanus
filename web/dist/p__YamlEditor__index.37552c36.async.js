"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[445],{5578:function(jn,V,s){s.r(V);var Pe=s(19632),b=s.n(Pe),ge=s(97857),j=s.n(ge),De=s(52677),D=s.n(De),pe=s(15009),v=s.n(pe),Ce=s(99289),A=s.n(Ce),be=s(5574),_=s.n(be),m=s(67294),z=s(55102),je=s(2453),Ze=s(72269),Le=s(37804),ye=s(84567),O=s(42075),E=s(83622),Me=s(86738),Z=s(2487),Y=s(4393),Ae=s(74330),Oe=s(64218),Fe=s(34041),$=s(17788),Ie=s(82061),Se=s(51042),xe=s(30723),Be=s(34804),k=s(40110),F=s(2618),L=s(86762),a=s(85893),I=z.Z.TextArea,Te=function(){var Re=je.ZP.useMessage(),G=_()(Re,2),c=G[0],We=G[1],Ue=(0,L.useParams)(),p=Ue.fileName,Ke=(0,m.useState)([]),H=_()(Ke,2),y=H[0],we=H[1],Ne=(0,m.useState)(""),J=_()(Ne,2),S=J[0],x=J[1],Ve=(0,m.useState)({}),Q=_()(Ve,2),C=Q[0],X=Q[1],ze=(0,m.useState)(!1),q=_()(ze,2),Ye=q[0],ee=q[1],$e=(0,m.useState)(!1),ne=_()($e,2),ke=ne[0],re=ne[1],Ge=(0,m.useState)(!1),ae=_()(Ge,2),He=ae[0],te=ae[1],Je=(0,m.useState)(""),se=_()(Je,2),T=se[0],Qe=se[1],Xe=(0,m.useState)([]),ue=_()(Xe,2),le=ue[0],ie=ue[1],qe=(0,m.useState)(!1),oe=_()(qe,2),en=oe[0],M=oe[1],nn=(0,m.useState)(!1),de=_()(nn,2),rn=de[0],R=de[1],an=(0,m.useState)(""),_e=_()(an,2),W=_e[0],U=_e[1],tn=(0,m.useState)(""),ce=_()(tn,2),sn=ce[0],un=ce[1],ln=(0,m.useState)([]),me=_()(ln,2),K=me[0],on=me[1],dn=(0,m.useState)({}),fe=_()(dn,2),g=fe[0],w=fe[1],_n=function(){var l=A()(v()().mark(function t(){var e;return v()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,F.fV)();case 3:e=n.sent,e.files?(we(e.files),e.files.length>0&&(x(e.files[0]),B(e.files[0]))):c.error("\u914D\u7F6E\u6587\u4EF6\u5217\u8868\u52A0\u8F7D\u5931\u8D25"),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),c.error("\u83B7\u53D6\u6587\u4EF6\u5217\u8868\u65F6\u51FA\u9519: "+n.t0);case 10:case"end":return n.stop()}},t,null,[[0,7]])}));return function(){return l.apply(this,arguments)}}(),B=function(){var l=A()(v()().mark(function t(e){var u;return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,ee(!0),r.next=4,(0,F.hq)(e);case 4:u=r.sent,u?(X(u),u.error&&c.error("\u9519\u8BEF\uFF1A".concat(u.error))):c.error("\u914D\u7F6E\u6587\u4EF6\u52A0\u8F7D\u5931\u8D25"),r.next=11;break;case 8:r.prev=8,r.t0=r.catch(0),c.error("\u914D\u7F6E\u6587\u4EF6\u52A0\u8F7D\u51FA\u9519: "+r.t0);case 11:return r.prev=11,ee(!1),r.finish(11);case 14:case"end":return r.stop()}},t,null,[[0,8,11,14]])}));return function(e){return l.apply(this,arguments)}}(),cn=function l(t){if(Array.isArray(t))return t.map(function(n){return typeof n=="string"&&!isNaN(Number(n))&&n.trim()!==""?Number(n):D()(n)==="object"&&n!==null?l(n):n});if(D()(t)==="object"&&t!==null){var e={};for(var u in t)t.hasOwnProperty(u)&&(e[u]=l(t[u]));return e}return t},mn=function(){var l=A()(v()().mark(function t(){var e,u;return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,re(!0),e=j()({},C),e.data&&(e.data=cn(e.data)),r.next=6,(0,F.sC)(S,e);case 6:u=r.sent,u.message?c.success("\u914D\u7F6E\u6587\u4EF6\u4FDD\u5B58\u6210\u529F"):c.error(u.error||"\u4FDD\u5B58\u5931\u8D25"),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(0),c.error("\u4FDD\u5B58\u914D\u7F6E\u6587\u4EF6\u65F6\u51FA\u9519: "+r.t0);case 13:return r.prev=13,re(!1),r.finish(13);case 16:case"end":return r.stop()}},t,null,[[0,10,13,16]])}));return function(){return l.apply(this,arguments)}}(),P=function(t,e){for(var u=t.split("."),n=j()({},C),r=n.data||n,f=0;f<u.length-1;f++){var d=u[f];if(d.includes("[")){var o=d.split("["),i=_()(o,2),h=i[0],Ee=i[1],gn=parseInt(Ee.replace("]",""),10);r=r[h][gn]}else r=r[d]}var N=u[u.length-1];if(N.includes("[")){var Dn=N.split("["),ve=_()(Dn,2),pn=ve[0],Cn=ve[1],bn=parseInt(Cn.replace("]",""),10);r[pn][bn]=e}else r[N]=e;X(n)},fn=function(t,e){un(t),on(e),U(""),R(!0)},hn=function(){if(!W.trim()){c.warning("\u8BF7\u8F93\u5165\u8981\u6DFB\u52A0\u7684\u5185\u5BB9\uFF01");return}var t=W.split(`
`).filter(function(u){return u.trim()!==""}),e=t.map(function(u){return K.length>0&&D()(K[0])==="object"?{}:u.trim()});P(sn,[].concat(b()(K),b()(e))),R(!1),U(""),c.success("\u6210\u529F\u6DFB\u52A0 ".concat(e.length," \u9879"))},En=function l(t,e){if(typeof t=="boolean")return(0,a.jsx)(Ze.Z,{checked:t,checkedChildren:"\u5F00",unCheckedChildren:"\u5173",onChange:function(r){return P(e,r)}});if(typeof t=="string")return(0,a.jsx)(I,{value:t,onChange:function(r){return P(e,r.target.value)},autoSize:{minRows:1,maxRows:5}});if(typeof t=="number")return(0,a.jsx)(Le.Z,{type:"number",value:t,style:{width:"100%"},onChange:function(r){r==null||P(e,r)}});if(Array.isArray(t)){var u;return(0,a.jsxs)("div",{className:"array-container",children:[t.map(function(n,r){var f;return(0,a.jsxs)("div",{className:"array-item",children:[(0,a.jsx)(ye.Z,{checked:((f=g[e])===null||f===void 0?void 0:f[r])||!1,onChange:function(o){var i=j()({},g);i[e]||(i[e]=Array(t.length).fill(!1)),i[e][r]=o.target.checked,w(i)}}),n===null?(0,a.jsx)(I,{value:n,onChange:function(o){var i=b()(t);i[r]=o.target.value,P(e,i)},autoSize:{minRows:1,maxRows:5}}):D()(n)==="object"?(0,a.jsx)("div",{className:"nested-object",style:{flex:1},children:Object.entries(n).map(function(d){var o=_()(d,2),i=o[0],h=o[1];return(0,a.jsxs)("div",{className:"object-item",children:[(0,a.jsxs)("strong",{children:[i,":"]}),(0,a.jsx)("div",{style:{marginLeft:"10px"},children:l(h,"".concat(e,"[").concat(r,"].").concat(i))})]},i)})}):(0,a.jsx)(I,{value:n,onChange:function(o){var i=b()(t);i[r]=o.target.value,P(e,i)},autoSize:{minRows:1,maxRows:5}})]},r)}),(0,a.jsxs)(O.Z,{wrap:!0,children:[(0,a.jsx)(E.ZP,{type:"dashed",onClick:function(){var r,f=j()({},g),d=((r=g[e])===null||r===void 0?void 0:r.every(function(o){return o}))||!1;f[e]=Array(t.length).fill(!d),w(f)},children:(u=g[e])!==null&&u!==void 0&&u.every(function(n){return n})?"\u53D6\u6D88\u5168\u9009":"\u5168\u9009"}),(0,a.jsx)(Me.Z,{title:"\u786E\u8BA4\u5220\u9664\u5417\uFF1F",placement:"topRight",onConfirm:function(){var r,f=((r=g[e])===null||r===void 0?void 0:r.map(function(i,h){return i?h:-1}).filter(function(i){return i!==-1}))||[];if(t.length-f.length<1){c.warning("\u81F3\u5C11\u9700\u8981\u4FDD\u7559\u4E00\u9879");return}if(f.length===0){c.warning("\u8BF7\u5148\u9009\u62E9\u8981\u5220\u9664\u7684\u9879");return}var d=t.filter(function(i,h){return!f.includes(h)});P(e,d);var o=j()({},g);o[e]=Array(d.length).fill(!1),w(o),c.success("\u6210\u529F\u5220\u9664 ".concat(f.length," \u9879"))},okText:"\u662F",cancelText:"\u5426",children:(0,a.jsxs)(E.ZP,{type:"dashed",danger:!0,children:[(0,a.jsx)(Ie.Z,{}),"\u5220\u9664\u9009\u4E2D"]})}),(0,a.jsx)(E.ZP,{type:"dashed",icon:(0,a.jsx)(Se.Z,{}),onClick:function(){var r=D()(t[0])==="object"?{}:"";P(e,[].concat(b()(t),[r]))},children:"\u6DFB\u52A0\u4E00\u9879"}),(0,a.jsx)(E.ZP,{type:"dashed",icon:(0,a.jsx)(xe.Z,{}),onClick:function(){fn(e,t)},children:"\u6279\u91CF\u6DFB\u52A0"})]})]})}return null},vn=function l(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"",r=u[n]||Object.keys(t);return(0,a.jsx)(Z.Z,{dataSource:r,bordered:!1,split:!1,renderItem:function(d){var o=t[d],i=n?"".concat(n,".").concat(d):d,h=e[i];return(0,a.jsx)(Z.Z.Item,{className:"yaml-item",id:"yaml-item-".concat(i),children:(0,a.jsxs)(Y.Z,{style:{padding:0},className:"yaml-content",children:[(0,a.jsxs)("div",{className:"key-container",children:[(0,a.jsxs)("strong",{style:{fontSize:"1.2rem"},children:[d,":"]}),h&&(0,a.jsx)("span",{style:{textIndent:"1em",opacity:.8,overflow:"visible",textOverflow:"unset",whiteSpace:"normal",display:"block",maxWidth:"100%"},className:"comment",dangerouslySetInnerHTML:{__html:h.replace(/((?:https?:\/\/)?(?:(?:[a-z0-9]?(?:[a-z0-9\-]{1,61}[a-z0-9])?\.[^\.|\s])+[a-z\.]*[a-z]+|(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3})(?::\d{1,5})*[a-z0-9.,_\/~#&=;%+?\-\\(\\)]*)/gi,'<a href="$&" target="_blank" style="word-break: break-all;">$&</a>')}})]}),n==="help_menu"&&d==="content"?(0,a.jsx)(E.ZP,{type:"primary",onClick:function(){L.history.push("/menuEditor")},children:"\u524D\u5F80\u83DC\u5355\u7F16\u8F91\u5668\u4FEE\u6539"}):D()(o)==="object"&&!Array.isArray(o)?(0,a.jsx)("div",{className:"nested-object",children:l(o,e,u,i)}):En(o,i)]})})}})};(0,m.useEffect)(function(){_n().then(function(){!p&&y.length>0&&L.history.replace("/configEditor/".concat(S))})},[]),(0,m.useEffect)(function(){p&&y.length>0&&y.includes(p)&&(x(p),B(p))},[p,y]);var he=function(){var l=A()(v()().mark(function t(){var e;return v()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(T.trim()){n.next=3;break}return c.warning("\u8BF7\u5148\u8F93\u5165\u8981\u641C\u7D22\u7684\u5185\u5BB9"),n.abrupt("return");case 3:return n.prev=3,te(!0),n.next=7,(0,F.yz)(T.trim());case 7:e=n.sent,e.results?(ie(e.results),M(!0)):e.error?c.error(e.error):(ie([]),M(!0),c.info("\u672A\u627E\u5230\u5339\u914D\u9879")),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(3),c.error("\u641C\u7D22\u65F6\u51FA\u9519: "+n.t0);case 14:return n.prev=14,te(!1),n.finish(14);case 17:case"end":return n.stop()}},t,null,[[3,11,14,17]])}));return function(){return l.apply(this,arguments)}}(),Pn=function(){return(0,a.jsx)(Z.Z,{dataSource:le,renderItem:function(e){return(0,a.jsxs)(Z.Z.Item,{children:[(0,a.jsx)(Z.Z.Item.Meta,{title:(0,a.jsxs)("div",{children:["\u8DEF\u5F84\uFF1A",e.path]}),description:(0,a.jsxs)("div",{children:["\u6587\u4EF6\uFF1A",e.file]})}),(0,a.jsx)(E.ZP,{type:"primary",onClick:function(){if(S!==e.file)x(e.file),B(e.file).then(function(){setTimeout(function(){var r=document.getElementById("yaml-item-".concat(e.path));r&&r.scrollIntoView({behavior:"smooth",block:"center"})},300)}),L.history.push("/configEditor/".concat(e.file,"?path=").concat(e.path));else{var n=document.getElementById("yaml-item-".concat(e.path));n?n.scrollIntoView({behavior:"smooth",block:"center"}):c.error("\u672A\u627E\u5230\u5BF9\u5E94\u4F4D\u7F6E")}M(!1)},children:"\u8DF3\u8F6C"})]},e.path)}})};return(0,a.jsxs)(Ae.Z,{spinning:Ye,size:"large",children:[We,(0,a.jsx)(Y.Z,{style:{padding:0},children:(0,a.jsxs)("div",{className:"yaml-editor",children:[(0,a.jsx)(Oe.Z,{offsetTop:60,children:(0,a.jsx)("div",{className:"file-controls",children:(0,a.jsxs)(O.Z,{wrap:!0,direction:"horizontal",style:{borderRadius:8,backdropFilter:"blur(8px)",padding:10,boxShadow:"0 0 10px rgba(112, 112, 112, 0.63)",width:"100%"},children:[(0,a.jsx)(Fe.Z,{style:{width:"320px"},value:S||void 0,placeholder:"\u9009\u62E9\u6587\u4EF6",onChange:function(t){x(t),B(t),L.history.push("/configEditor/".concat(t)),window.scrollTo({top:0,behavior:"smooth"})},suffixIcon:(0,a.jsx)(Be.Z,{}),options:y.map(function(l){return{value:l,label:l}})}),(0,a.jsx)(E.ZP,{type:"primary",onClick:mn,loading:ke,children:"\u4FDD\u5B58\u914D\u7F6E"}),(0,a.jsxs)(E.ZP,{type:"primary",onClick:function(){return M(!0)},children:[(0,a.jsx)(k.Z,{}),"\u641C\u7D22\u914D\u7F6E\u9879"]})]})})}),(0,a.jsx)("div",{className:"editor-content",children:C.data&&vn(C.data,C.comments,C.order)}),(0,a.jsx)($.Z,{title:"\u6279\u91CF\u6DFB\u52A0",open:rn,onOk:hn,onCancel:function(){return R(!1)},width:600,okText:"\u6DFB\u52A0",cancelText:"\u53D6\u6D88",children:(0,a.jsx)(I,{value:W,onChange:function(t){return U(t.target.value)},placeholder:"\u8BF7\u8F93\u5165\u8981\u6DFB\u52A0\u7684\u6570\u636E\uFF0C\u56DE\u8F66\u6362\u884C\uFF0C\u6BCF\u884C\u4E00\u9879",autoSize:{minRows:5,maxRows:20},style:{width:"100%"}})}),(0,a.jsx)($.Z,{title:"\u641C\u7D22\u914D\u7F6E\u9879",open:en,onCancel:function(){return M(!1)},width:800,footer:null,children:(0,a.jsxs)(O.Z,{direction:"vertical",style:{width:"100%"},children:[(0,a.jsxs)(O.Z,{children:[(0,a.jsx)(z.Z,{prefix:(0,a.jsx)(k.Z,{}),placeholder:"\u641C\u7D22\u914D\u7F6E\u9879...",value:T,onChange:function(t){return Qe(t.target.value)},onPressEnter:he,style:{width:"100%"}}),(0,a.jsx)(E.ZP,{type:"primary",onClick:he,loading:He,children:"\u641C\u7D22"})]}),(0,a.jsx)("div",{children:"\u63D0\u793A\uFF1A\u641C\u7D22\u8303\u56F4\u5305\u62EC\u5176\u5B83\u914D\u7F6E\u6587\u4EF6\uFF0C\u82E5\u5BF9\u5F53\u524D\u914D\u7F6E\u6587\u4EF6\u6709\u4FEE\u6539\uFF0C\u8BF7\u5148\u4FDD\u5B58\u540E\u518D\u8DF3\u8F6C\u3002"}),(0,a.jsx)("div",{style:{marginTop:"20px"},children:le.length>0?Pn():(0,a.jsx)("p",{children:"\u672A\u627E\u5230\u5339\u914D\u9879"})})]})}),(0,a.jsx)("style",{children:`
        .yaml-editor {
          // padding: 20px;
        }
        .file-controls {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 20px;
          display: flex;
          gap: 5px;
          padding: 5px;
        }
        .yaml-item {
          // border: 1px solid #e8e8e8;
          // padding: 5px;
          // margin-bottom: 10px;
          border-radius: 5px;
        }
        .yaml-content {
          width: 100%;
        }
        .key-container {
          margin-bottom: 8px;
        }
        .comment {
          margin-left: 8px;
        }
        .nested-object {
          margin-left: 20px;
        }
        .array-container {
          display: flex;
          flex-direction: column;
          gap: 8px;
        }
        .array-item {
          display: flex;
          gap: 8px;
          align-items: center;
        }
      `})]})},"a")]})};V.default=Te}}]);
