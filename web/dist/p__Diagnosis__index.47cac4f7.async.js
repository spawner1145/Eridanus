"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[341],{50666:function(ut,N,n){n.r(N);var fe=n(64599),me=n.n(fe),ve=n(5574),u=n.n(ve),r=n(67294),O=n(34041),Ee=n(71471),A=n(98142),S=n(2453),z=n(4393),B=n(42075),F=n(83622),he=n(55102),Pe=n(74330),ge=n(40110),De=n(69753),pe=n(27484),E=n.n(pe),$=n(2618),G=n(4244),st=n.n(G),J=n(78267),lt=n.n(J),ot=n(24078),Le=n(86762),a=n(85893),R=O.Z.Option,_t=Ee.Z.Text,ct=A.default.RangePicker,Me=function(){var Z,Oe=(0,r.useState)([]),Q=u()(Oe,2),Se=Q[0],j=Q[1],xe=(0,r.useState)(""),V=u()(xe,2),h=V[0],X=V[1],Ce=(0,r.useState)([]),k=u()(Ce,2),P=k[0],Te=k[1],Ae=(0,r.useState)([]),q=u()(Ae,2),ee=q[0],Be=q[1],Fe=(0,r.useState)(""),te=u()(Fe,2),x=te[0],Re=te[1],Ze=(0,r.useState)(""),ne=u()(Ze,2),g=ne[0],I=ne[1],je=(0,r.useState)(E()().subtract(30,"minutes")),re=u()(je,2),y=re[0],Ie=re[1],ye=(0,r.useState)(E()()),ae=u()(ye,2),U=ae[0],Ue=ae[1],We=(0,r.useState)([]),ie=u()(We,2),W=ie[0],be=ie[1],Ke=(0,r.useState)(["ERROR"]),ue=u()(Ke,2),b=ue[0],Ye=ue[1],He=(0,r.useState)(E()().subtract(30,"minutes")),se=u()(He,2),D=se[0],we=se[1],Ne=(0,r.useState)(E()()),le=u()(Ne,2),p=le[0],ze=le[1],$e=(0,r.useState)([]),oe=u()($e,2),f=oe[0],Ge=oe[1],Je=(0,r.useState)(["ERROR"]),_e=u()(Je,2),m=_e[0],Qe=_e[1],Ve=(0,r.useState)(!1),ce=u()(Ve,2),Xe=ce[0],C=ce[1],T=(0,r.useRef)(null),d=(0,r.useRef)(null),L=(0,r.useRef)(null),ke=(0,Le.useModel)("@@initialState"),K=ke.initialState,i=(K==null||(Z=K.settings)===null||Z===void 0?void 0:Z.isDark)||!1;(0,r.useEffect)(function(){(0,$.xA)().then(function(e){if(e&&Array.isArray(e.files)){if(j(e.files),e.files.length>0){var t=e.files[e.files.length-1];X(t)}}else j([]),S.ZP.error((e==null?void 0:e.error)||"\u670D\u52A1\u5668\u8FD4\u56DE\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E")}).catch(function(e){j([]),S.ZP.error("\u83B7\u53D6\u6587\u4EF6\u5217\u8868\u5931\u8D25: "+e.message)})},[]),(0,r.useEffect)(function(){h&&de()},[h]),(0,r.useEffect)(function(){if(T.current){d.current=new G.Terminal({rows:1e4,cols:120,cursorBlink:!0,scrollback:1e6,theme:{background:i?"#1e1e1e":"#fbfbfb",foreground:i?"#d4d4d4":"#000",selectionBackground:i?"#333":"#ccc",cursor:i?"#eee":"#111",red:i?"#ff6f6f":"#ee1111",green:i?"#4cab4c":"#1e9400",yellow:i?"#c3c323":"#e59900"}}),L.current=new J.FitAddon,d.current.loadAddon(L.current),d.current.open(T.current),L.current.fit();var e=function(){L.current&&L.current.fit()};return window.addEventListener("resize",e),function(){var t;window.removeEventListener("resize",e),(t=d.current)===null||t===void 0||t.dispose()}}},[T]),(0,r.useEffect)(function(){d.current&&(d.current.options.theme={background:i?"#1e1e1e":"#fbfbfb",foreground:i?"#d4d4d4":"#000",selectionBackground:i?"#333":"#ccc",cursor:i?"#eee":"#111",red:i?"#ff6f6f":"#ee1111",green:i?"#4cab4c":"#1e9400",yellow:i?"#c3c323":"#e59900"})},[i]);var qe=function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;d.current&&(o&&d.current.clear(),t.forEach(function(c,_){var s,l="";switch(c.level){case"ERROR":l="\x1B[31m";break;case"WARNING":l="\x1B[33m";break;case"INFO":l="\x1B[32m";break;default:l=i?"\x1B[37m":"\x1B[30m"}var v="".concat(l).concat(c.timestamp," ").concat(c.app," ").concat(c.level," ").concat(c.message,"\x1B[0m");(s=d.current)===null||s===void 0||s.write(v+`\r
\r
`)}))},et=function(t){if(!t||typeof t!="string")return[];var o=t.split(`
`).filter(function(w){return w.trim()!==""}),c=[],_=null,s=me()(o),l;try{for(s.s();!(l=s.n()).done;){var v=l.value,M=v.split(" - ");M.length>=4?(_&&c.push(_),_={timestamp:M[0]||"",app:M[1]||"",level:M[2]||"",message:M.slice(3).join(" - ")||""}):_?_.message+=`
`+v:v.trim()!==""&&(_={timestamp:"",app:"",level:"",message:v})}}catch(w){s.e(w)}finally{s.f()}return _&&c.push(_),c},de=function(){h&&(C(!0),(0,$.Bl)({file:h}).then(function(t){if(t&&typeof t=="string"){var o=et(t);Te(o)}else S.ZP.error((t==null?void 0:t.error)||"\u670D\u52A1\u5668\u8FD4\u56DE\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E")}).catch(function(t){S.ZP.error("\u83B7\u53D6\u65E5\u5FD7\u5185\u5BB9\u5931\u8D25: "+t.message)}).finally(function(){C(!1)}))},Y=(0,r.useMemo)(function(){var e=P;return D&&p&&(e=e.filter(function(t){var o=E()(t.timestamp,"YYYY-MM-DD HH:mm:ss");return o.isSameOrAfter(D)&&o.isSameOrBefore(p)})),f&&f.length>0&&(e=e.filter(function(t){return f.includes(t.app)})),m&&m.length>0&&(e=e.filter(function(t){return m.includes(t.level)})),e},[P,D,p,f,m]),H=(0,r.useMemo)(function(){return g?Y.filter(function(e){return e.message.includes(g)}):Y},[Y,g]);(0,r.useEffect)(function(){Be(H),qe(H,!0)},[H]);var tt=function(){C(!0),setTimeout(function(){we(y),ze(U),Ge(W),Qe(b),I(x),C(!1)},500)};(0,r.useEffect)(function(){P.length>0&&tt()},[y,U,W,b]);var nt=Array.from(new Set(P.map(function(e){return e.app}))),rt=Array.from(new Set(P.map(function(e){return e.level}))),at=function(){var t=it(),o=ee.map(function(l){return"".concat(l.timestamp," ").concat(l.app," ").concat(l.level," ").concat(l.message)}).join(`

`),c=new Blob([o],{type:"text/plain;charset=utf-8"}),_=URL.createObjectURL(c),s=document.createElement("a");s.href=_,s.download="".concat(t,".log"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(_)},it=function(){var t="";if(D&&(t+="_".concat(D.format("YYYYMMDD_HHmmss"))),p&&(t+="_".concat(p.format("YYYYMMDD_HHmmss"))),f&&f.length>0&&(t+="_".concat(f.join("_"))),m&&m.length>0&&(t+="_".concat(m.join("_"))),g){var o=g.replace(/[^a-zA-Z0-9\u4e00-\u9fa5]/g,"_");t+="_search_".concat(o)}return t=t.replace(/[^a-zA-Z0-9\u4e00-\u9fa5]/g,"_"),t};return(0,a.jsx)("div",{children:(0,a.jsx)(z.Z,{children:(0,a.jsxs)(B.Z,{direction:"vertical",style:{width:"100%",marginTop:"20px"},children:[(0,a.jsxs)(B.Z,{wrap:!0,children:[(0,a.jsx)(O.Z,{placeholder:"\u9009\u62E9\u65E5\u5FD7\u6587\u4EF6",style:{width:200},onChange:function(t){return X(t)},value:h,children:(Se||[]).map(function(e){return(0,a.jsx)(R,{value:e,children:e},e)})}),(0,a.jsx)(F.ZP,{onClick:de,type:"primary",children:"\u5237\u65B0\u65E5\u5FD7"})]}),(0,a.jsxs)(B.Z,{wrap:!0,children:[(0,a.jsx)(A.default,{showTime:{format:"HH:mm:ss"},placeholder:"\u5F00\u59CB\u65F6\u95F4",style:{width:200},value:y,onChange:function(t){return Ie(t)},format:"YYYY-MM-DD HH:mm:ss"}),(0,a.jsx)(A.default,{showTime:{format:"HH:mm:ss"},placeholder:"\u7ED3\u675F\u65F6\u95F4",style:{width:200},value:U,onChange:function(t){return Ue(t)},format:"YYYY-MM-DD HH:mm:ss"}),(0,a.jsx)(O.Z,{mode:"multiple",placeholder:"\u6A21\u5757\u7B5B\u9009",style:{width:200},value:W,onChange:function(t){return be(t)},children:(nt||[]).map(function(e){return(0,a.jsx)(R,{value:e,children:e},e)})}),(0,a.jsx)(O.Z,{mode:"multiple",placeholder:"\u65E5\u5FD7\u7B49\u7EA7\u7B5B\u9009",style:{width:200},value:b,onChange:function(t){return Ye(t)},children:(rt||[]).map(function(e){return(0,a.jsx)(R,{value:e,children:e},e)})}),(0,a.jsx)(he.Z,{placeholder:"\u641C\u7D22\u65E5\u5FD7\u5185\u5BB9...",style:{width:200},prefix:(0,a.jsx)(ge.Z,{}),value:x,onChange:function(t){return Re(t.target.value)},onPressEnter:function(){return I(x)}}),(0,a.jsx)(F.ZP,{style:{width:60},onClick:function(){return I(x)},type:"primary",children:"\u641C\u7D22"}),(0,a.jsx)(F.ZP,{style:{width:130},onClick:at,icon:(0,a.jsx)(De.Z,{}),children:"\u5BFC\u51FA\u5F53\u524D\u65E5\u5FD7"})]}),(0,a.jsx)(Pe.Z,{spinning:Xe,delay:200,children:(0,a.jsx)(z.Z,{title:"\u65E5\u5FD7\u5185\u5BB9 (".concat(ee.length," \u6761\u8BB0\u5F55)"),children:(0,a.jsx)("div",{className:"terminal-container",style:{width:"100%",height:"600px",overflow:"auto",position:"relative"},children:(0,a.jsx)("div",{ref:T,style:{width:"100%",height:"600px",backgroundColor:i?"#1e1e1e":"#ffffff",padding:"-5px",overflow:"hidden"}})})})})]})},"0")})};N.default=Me}}]);
