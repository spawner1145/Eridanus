llm:
  model: gemini  #选择使用的模型大类。default为自带免费模型，可选openai、gemini。
  system: "" #建议用chara_file_name，而不是在此处填写，此配置即将被弃用
  chara_file_name: 猫娘.txt   #system为""时生效,默认启动的人设文件名，在data/system/chara文件夹内(目前支持txt,json,酒馆角色卡(图片))
  openai:          #兼容所有openai标准接口。https://platform.openai.com/docs/overview
    enable_official_sdk: true   #是否使用官方sdk，如果不使用，则为直接发送post请求。
    api_keys:   #继续像这样添加apikey
    - YOUR_API_KEY_1
    model: deepseek-reasoner
    quest_url: https://api.deepseek.com   #如使用官方sdk，则只填base_url，否则填完整url。
    temperature: 1.0
    max_tokens: 2048
    CoT: true               #显示思维链
    使用旧版prompt结构: false  #部分模型需要使用旧版prompt结构
  gemini:         #https://ai.google.dev/
    api_keys:  #继续像这样添加apikey
    - 111
    model: gemini-3-flash-preview #换模型改这里没用，改fallback_models
    base_url: https://generativelanguage.googleapis.com                   #后面的/v1/beta什么的会自动填充
    temperature: 0.7
    maxOutputTokens: 2048
    include_thoughts: true   #是否在输出中包含思维链，false则隐藏思考过程只返回正文
    fallback_models:   #code429即到达限额后，会按顺序change_model，直到成功。
    - gemini-3-flash-preview
    - gemini-2.5-flash
    - gemini-2.0-flash-lite
    - gemini-2.5-flash-lite
  default:  #default全系列模型无函数调用，仅支持日常对话。
    model: gpt-4o-mini #可选claude-3-5-haiku，gpt-4-turbo-preview，gpt-4o-mini，gpt-4-32k，@cf/google/gemma-7b-it-lora，meta-llama/Llama-3.3-70B-Instruct-Turbo
  腾讯元器:     #极其不建议用，腾子搞得玩意稀烂，而且不支持函数调用。
    智能体ID: ""
    token: ""
  func_calling: true  #开启函数调用功能
  表情包发送: true      #记录master发送的表情包并在回复时根据上下文发送。
  单次发送表情包数量: 1  #单次发送最大表情包数量
  google_search: false       #Gemini官方版本联网搜索功能，开启后会禁用自定义联网函数(search_net, read_html)
  url_context: false         #Gemini官方URL上下文功能，可以自动抓取URL内容，开启后会禁用自定义联网函数(search_net, read_html)
  联网搜索显示原始数据: true   #显示搜索来源和grounding metadata
  search_client:            #搜索专用client配置（google_search或url_context开启时使用，仅支持gemini）
    api_key: "" #搜索专用API Key，留空则使用gemini的api_keys
    base_url: "https://generativelanguage.googleapis.com" #搜索专用Base URL，留空则使用gemini的base_url
    model: "" #搜索专用模型名，留空则使用gemini的fallback_models列表
  utility_client:           #通用任务client配置（用于用户画像总结等任务）
    type: "gemini"          #可选 "openai" 或 "gemini"
    api_key: ""             #专用API Key，留空则根据type使用对应的api_keys
    base_url: ""            #专用Base URL，留空则根据type使用对应的base_url
    model: ""                 #专用模型名，留空则根据type使用对应的默认模型/fallback_models
  读取群聊上下文: true  # 开启后记录群聊消息到数据库，供群总结、仁济模式等功能使用
  群消息保留数量: 30     # 每个群保留的最大消息数量
  上下文带原文: true  # 在AI请求中附带群聊上下文原文消息（需先开启读取群聊上下文）
  上下文带图片原文: false  # 是否在上下文原文中包含图片（需视觉模型支持，会增加token消耗）
  可获取的群聊上下文长度: 10 # 附带原文时读取的消息条数，仁济模式算法回复也会用到
  用户画像: true   #ai总结用户特征，构建用户画像
  用户画像更新间隔: 360  #单位秒
  群聊总结: # 需先开启读取群聊上下文
    enable: true            #开启群聊总结功能
    总结间隔消息数: 10      #每隔多少条消息自动生成总结，同时也是读取用于总结的消息数量
    聊天带总结: true        #是否在AI回复时注入群聊总结到prompt中
    读取图片: false          #是否在总结时读取图片内容（需要视觉模型支持，会增加token消耗）
    whitelist_enabled: true  #关闭则所有群都启用
    chat_whitelist:          #白名单群配置项，如果开了白名单模式而且不在白名单的群只有主动发送/群总结 刷新才会触发群总结，而不会自动触发群总结
    - 1050663831
  prefix: #可以用于触发bot的指令前缀
  - 测试机
  aiReplyCore: true   #ai回复核心，将优化其他功能回复表现
  enable_proxy: false
  max_history_length: 40 #最大上下文长度
  仁济模式:
    随机回复概率: 0  #随机回复概率，0-100，0为不随机。
    算法回复:     #数值越大越不易触发
      enable: false
      相似度阈值: 30
      频率阈值: 15
      消息列表最小长度: 10
      信息熵阈值: 2
    延时相关性:   #一定时间内自动判断话题是否相关并回复。
      enable: false
      置信度阈值: 0.9   #越高越难触发。0-1，可以是0.92这种两位小数
      有效延时: 100      #单位秒
  Quote: false     #回复时引用
  语音回复几率: 30
  语音回复附带文本: true
  自动清理无效apikey: false
  retries: 3                           #LLM请求重试次数，每个模型重试次数
heartflow:     #心流模式，自动根据群聊内容回复，需完成相关client配置。
  enabled: false
  system: ""   #心流专用角色文件名，填写后直接使用该文件（不进行总结精简），留空则使用主llm的角色并自动总结
  listen_image: false   #是否监听图片，开启后判断是否回复时会读取图片内容
  client:                    #心流专用client配置，类似utility_client
    type: "gemini"           #可选 "openai" 或 "gemini"
    api_key: ""              #专用API Key，留空则根据type使用对应的api_keys
    base_url: "https://generativelanguage.googleapis.com"             #专用Base URL，留空则根据type使用对应的base_url
    model: "gemma-3-27b-it"  #专用模型名，留空则根据type使用对应的默认模型/fallback_models
    temperature: 0.7         #温度参数，留空则使用对应type的默认值
    max_tokens: 2048         #最大输出token数
  reply_threshold: 0.6
  energy_decay_rate: 0.1
  energy_recovery_rate: 0.02
  context_messages_count: 10 # 读取的消息条数
  interaction_timeout: 300
  whitelist_enabled: true  #关闭则所有群都启用
  chat_whitelist:   #白名单群
  - 1050663831
  - 699455559
  weight_relevance: 0.25
  weight_willingness: 0.2
  weight_social: 0.2
  weight_timing: 0.15
  weight_continuity: 0.2
core:
  ai_reply_group: 0    #群内ai对话所需权限等级
  ai_reply_private: 0  #私聊ai对话所需权限等级
  ai_change_character: 0  #ai更换角色所需权限等级
  ai_token_limt: 0 #不限制ai对话token所需权限等级
  ai_token_limt_token: 10000 #一般用户限制ai对话token数量
